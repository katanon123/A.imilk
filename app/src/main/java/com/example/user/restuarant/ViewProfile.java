package com.example.user.restuarant;import android.app.AlertDialog;import android.content.DialogInterface;import android.content.Intent;import android.content.SharedPreferences;import android.os.Build;import android.os.Bundle;import android.os.StrictMode;import android.support.v7.app.AppCompatActivity;import android.text.SpannableString;import android.text.style.UnderlineSpan;import android.util.Log;import android.view.View;import android.view.WindowManager;import android.widget.Button;import android.widget.TextView;import com.example.user.restuarant.commonclass.ReadJson;import org.json.JSONArray;import org.json.JSONException;import org.json.JSONObject;import java.util.HashMap;public class ViewProfile extends AppCompatActivity {    private ReadJson readJson;    private TextView firstname_pro_textView, lastname_pro_textView,  email_pro_textView, mobilephonenumber_pro_textView,ChanngePassword_pro_textView;    private String resultJson, url;    private Button singout_button, Sigin_profile_button;    String webservicepath;    TextView firstname_textView,lastname_profile_textView,email_textView,mobilephonenumber_textView,            Password_Profile_textView,profile_textView;    String p149,p150,p163;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_view_profile);        if(Build.VERSION.SDK_INT > 9)        {            StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder()                    .permitAll().build();            StrictMode.setThreadPolicy(policy);        }        this.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN); //ไม่ให้keybordเด้งขึ้นอัตโนมัติ        webservicepath = getResources().getString(R.string.path_webservice);        readJson = new ReadJson();        ChanngePassword_pro_textView = (TextView)findViewById(R.id.ChanngePassword_pro_textView);        SpannableString content = new SpannableString("เปลี่ยนรหัสผ่าน");        content.setSpan(new UnderlineSpan(), 0, content.length(), 0);        ChanngePassword_pro_textView.setText(content);        firstname_pro_textView  = (TextView)findViewById(R.id.firstname_pro_textView);        lastname_pro_textView = (TextView)findViewById (R.id.lastname_pro_textView);        email_pro_textView = (TextView)findViewById(R.id.email_pro_textView);        mobilephonenumber_pro_textView = (TextView)findViewById(R.id.mobilephonenumber_pro_textView);        Sigin_profile_button = (Button)findViewById(R.id.Sigin_profile_button);        singout_button = (Button)findViewById(R.id.singout_button);        firstname_textView = (TextView)findViewById(R.id.firstname_textView);        lastname_profile_textView = (TextView)findViewById(R.id.lastname_profile_textView);        email_textView = (TextView)findViewById(R.id.email_textView);        mobilephonenumber_textView = (TextView)findViewById(R.id.mobilephonenumber_textView);        Password_Profile_textView = (TextView)findViewById(R.id.Password_Profile_textView);        profile_textView = (TextView)findViewById(R.id.profile_textView);        ChanngePassword_pro_textView.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View v) {                Intent intent = new Intent(getApplication(),ChangePassWord.class);                startActivity(intent);            }        });        singout_button.setVisibility(View.GONE); //ซ่อนปุ่มเมื่อยังไม่ได้ login        Sigin_profile_button.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View v) {                Intent intent = new Intent(getApplication(),Login.class);                startActivity(intent);                finish();            }        });        singout_button.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View v) {                final AlertDialog.Builder adb = new AlertDialog.Builder(ViewProfile.this);                adb.setMessage(p163);//ดักว่าแน่ใจหรือไม่ที่จะออก                adb.setNegativeButton(p150, new AlertDialog.OnClickListener() {                    public void onClick(DialogInterface dialog, int arg1) {                        final SharedPreferences settings = getSharedPreferences("UserInfo", 0);                        settings.edit().clear().commit();                        final SharedPreferences settings2 = getSharedPreferences("Language", 0);                        settings2.edit().clear().commit();                        Intent intent = new Intent(getApplication(), Login.class);                        startActivity(intent);                        finish();                    }                });                adb.setNeutralButton(p149, new DialogInterface.OnClickListener() {                    @Override                    public void onClick(DialogInterface dialog, int which) {                    }                });                adb.show();            }        });        setPage();        getMassage();        getData();    }    private void setPage(){        firstname_pro_textView.setText("");        lastname_pro_textView.setText("");        email_pro_textView.setText("");        mobilephonenumber_pro_textView.setText("");    }    private void getData(){        SharedPreferences cookie = getSharedPreferences("UserInfo", 0);//เรียกใช้ คุ้กกี้        int UserId  = cookie.getInt("sId", 0);        if (UserId != 0){            readJson = new ReadJson();            url = webservicepath+"GetUserAccountById/"+UserId;//            url ="http://services.totiti.net/DSME289Wcf/Service1.svc/GetUserAccountById/"+UserId;            resultJson = "GetUserAccountByIdResult";            singout_button.setVisibility(View.VISIBLE); //แสดงปุ่มเมื่อ login แล้ว            String jsonResult = readJson.getHttpGet(url);            String Email = null, FirstName = null, LastName = null, MobilePhoneNumber = null;            try {                JSONObject jsonObMain = new JSONObject(jsonResult);                JSONArray data = jsonObMain.getJSONArray(resultJson);                for (int i = 0; i < data.length(); i++) {                    JSONObject c = data.getJSONObject(i);                    Email = c.getString("Email");                    FirstName = c.getString("FirstName");                    LastName = c.getString("LastName");                    MobilePhoneNumber = c.getString("MobilePhoneNumber");                }                firstname_pro_textView.setText(FirstName);                lastname_pro_textView.setText(LastName);                email_pro_textView.setText(Email);                mobilephonenumber_pro_textView.setText(MobilePhoneNumber);                ChanngePassword_pro_textView.setVisibility(View.VISIBLE);            } catch (JSONException e) {                e.printStackTrace();                Log.e("error", e.toString());            }        }else        {            Sigin_profile_button.setVisibility(View.VISIBLE);        }    }    private void getMassage() {        readJson = new ReadJson();        //เรียกใช้คุกกี้ภาษา        SharedPreferences cookieLanguage = getSharedPreferences("Language", 0);//เรียกใช้ คุ้กกี้        String Language = cookieLanguage.getString("sName", "English");        HashMap<String, String> map;        url = webservicepath+"GetTextmessage";        String resultJson = "GetTextmessageResult";        String jsonResult = readJson.getHttpGet(url);        try {            JSONObject jsonObMain = new JSONObject(jsonResult);//Object            JSONArray data = jsonObMain.getJSONArray(resultJson);//Array            for (int i = 0; i < data.length(); i++) {                JSONObject c = data.getJSONObject(i);//Object                switch(c.getInt("Id")) {                    case 131://ชื่อ                        firstname_textView.setText(c.getString(Language));                        break;                    case 132://นามสกุล                        lastname_profile_textView.setText(c.getString(Language));                        break;                    case 133://อีเมล์                        email_textView.setText(c.getString(Language));                        break;                    case 134://เบอร์โทรศัพท์                        mobilephonenumber_textView.setText(c.getString(Language));                        break;                    case 160://รหัสผ่าน                        Password_Profile_textView.setText(c.getString(Language));                        break;                    case 129://ข้อมูลส่วนตัว                        profile_textView.setText(c.getString(Language));                        break;                    case 149://ไม่ใช่                        p149 = c.getString(Language);                        break;                    case 150://ใช่                        p150 = c.getString(Language);                        break;                    case 163://ออกจากระบบ                        p163 = c.getString(Language);                        singout_button.setText(c.getString(Language));                        break;                    case 206://เปลี่ยนรหัสผ่าน                        ChanngePassword_pro_textView.setText(c.getString(Language));                        break;                    default:                }            }        } catch (JSONException e) {            e.printStackTrace();            Log.e("error", e.toString());        }    } //จบ}